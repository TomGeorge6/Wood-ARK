# ç»¼åˆæŠ¥å‘Šé•¿å›¾è®¾è®¡è¯´æ˜

## æ¦‚è¿°

Wood-ARK ç³»ç»Ÿç°åœ¨ä¼šç”Ÿæˆå•å¼ ç»¼åˆæŠ¥å‘Šé•¿å›¾ï¼ŒåŒ…å«æ‰€æœ‰æŠ•èµ„åˆ†æä¿¡æ¯ï¼Œä¾¿äºåœ¨ä¼ä¸šå¾®ä¿¡ä¸­ä¸€æ¬¡æ€§æŸ¥çœ‹ã€‚

## é•¿å›¾ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š æŒä»“æ’åè¡¨æ ¼ (Top 15)                    â”‚
â”‚  - æ’åã€è‚¡ç¥¨ä»£ç ã€å…¬å¸åç§°                   â”‚
â”‚  - æŒè‚¡æ•°ã€å¸‚å€¼ã€æƒé‡                         â”‚
â”‚  (é«˜åº¦: ~10 è‹±å¯¸)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ˆ åŸºé‡‘æ€»å¸‚å€¼è¶‹åŠ¿åˆ†æ                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ 1 ä¸ªæœˆè¶‹åŠ¿   â”‚ 3 ä¸ªæœˆè¶‹åŠ¿    â”‚           â”‚
â”‚  â”‚  - æ€»å¸‚å€¼æŠ˜çº¿â”‚  - æ€»å¸‚å€¼æŠ˜çº¿ â”‚           â”‚
â”‚  â”‚  - åŒºåŸŸå¡«å……  â”‚  - åŒºåŸŸå¡«å……   â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ æ—¥åº¦å˜åŒ–ç‡   â”‚ æ—¥åº¦å˜åŒ–ç‡    â”‚           â”‚
â”‚  â”‚  (1ä¸ªæœˆ)     â”‚  (3ä¸ªæœˆ)      â”‚           â”‚
â”‚  â”‚  - æŸ±çŠ¶å›¾    â”‚  - æŸ±çŠ¶å›¾     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚  (é«˜åº¦: ~16 è‹±å¯¸)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š Top 10 ä¸ªè‚¡æƒé‡è¶‹åŠ¿                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ 1 ä¸ªæœˆè¶‹åŠ¿   â”‚ 3 ä¸ªæœˆè¶‹åŠ¿    â”‚           â”‚
â”‚  â”‚  - 10æ¡æŠ˜çº¿  â”‚  - 10æ¡æŠ˜çº¿   â”‚           â”‚
â”‚  â”‚  - å¸¦æ ‡è®°ç‚¹  â”‚  - å¸¦æ ‡è®°ç‚¹   â”‚           â”‚
â”‚  â”‚  - å›¾ä¾‹æ˜¾ç¤º  â”‚  - å›¾ä¾‹æ˜¾ç¤º   â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚  (é«˜åº¦: ~12 è‹±å¯¸)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æŠ€æœ¯å‚æ•°

### å›¾ç‰‡è§„æ ¼
- **æ€»å°ºå¯¸**ï¼š1788 x 4592 åƒç´ ï¼ˆå®½ x é«˜ï¼‰
- **ç‰©ç†å°ºå¯¸**ï¼š14 x 38 è‹±å¯¸ï¼ˆçº¦ 35.6 x 96.5 å˜ç±³ï¼‰
- **åˆ†è¾¨ç‡**ï¼š150 DPI
- **æ–‡ä»¶å¤§å°**ï¼šçº¦ 600-700 KB
- **æ ¼å¼**ï¼šPNGï¼ˆæ”¯æŒä¼ä¸šå¾®ä¿¡ç›´æ¥æ˜¾ç¤ºï¼‰

### å¸ƒå±€æ¯”ä¾‹
- æŒä»“è¡¨æ ¼ï¼š26% (10/38)
- åŸºé‡‘è¶‹åŠ¿ï¼š42% (16/38)
- ä¸ªè‚¡è¶‹åŠ¿ï¼š32% (12/38)

## æ•°æ®å±•ç¤ºé€»è¾‘

### 1. æŒä»“æ’åè¡¨æ ¼
- **æ’åºè§„åˆ™**ï¼š
  - ä¸»æ’åºï¼šæƒé‡é™åº
  - å‰¯æ’åºï¼šå¸‚å€¼é™åºï¼ˆæƒé‡ç›¸åŒæ—¶ï¼‰
- **æ˜¾ç¤ºæ•°é‡**ï¼šTop 15
- **å­—æ®µè¯´æ˜**ï¼š
  - æŒè‚¡æ•°ï¼šä½¿ç”¨ K/M å•ä½ï¼ˆå¦‚ 1.2Mï¼‰
  - å¸‚å€¼ï¼šç¾å…ƒæ ¼å¼ï¼ˆå¦‚ $280Mï¼‰
  - æƒé‡ï¼šç™¾åˆ†æ¯”ï¼ˆä¿ç•™2ä½å°æ•°ï¼‰

### 2. åŸºé‡‘æ€»å¸‚å€¼è¶‹åŠ¿

#### æ•°æ®è¦æ±‚
- **æœ€å°‘å¤©æ•°**ï¼š5 å¤©
- **1 ä¸ªæœˆè§†å›¾**ï¼šæœ€è¿‘ 30 ä¸ªäº¤æ˜“æ—¥
- **3 ä¸ªæœˆè§†å›¾**ï¼šæœ€è¿‘ 90 ä¸ªäº¤æ˜“æ—¥

#### å¯è§†åŒ–å…ƒç´ 
1. **æŠ˜çº¿å›¾**ï¼š
   - 1 ä¸ªæœˆï¼šæ·±è“è‰² (#2E86AB)
   - 3 ä¸ªæœˆï¼šç´«çº¢è‰² (#A23B72)
   - å¸¦æ ‡è®°ç‚¹ï¼ˆmarker='o'ï¼‰
   - åŒºåŸŸå¡«å……ï¼ˆalpha=0.3ï¼‰

2. **æ—¥åº¦å˜åŒ–ç‡æŸ±çŠ¶å›¾**ï¼š
   - ç»¿è‰²ï¼šæ­£å˜åŒ– (#00C853)
   - çº¢è‰²ï¼šè´Ÿå˜åŒ– (#D32F2F)
   - é›¶çº¿ï¼šé»‘è‰²å®çº¿

#### Y è½´æ ¼å¼
- æ€»å¸‚å€¼ï¼š$XXB æˆ– $XXXM
- å˜åŒ–ç‡ï¼šX.X%

#### X è½´æ˜¾ç¤º
- 1 ä¸ªæœˆï¼šæ¯ ~3 å¤©æ˜¾ç¤ºä¸€ä¸ªæ—¥æœŸ
- 3 ä¸ªæœˆï¼šæ¯ ~6 å¤©æ˜¾ç¤ºä¸€ä¸ªæ—¥æœŸ
- æ—¥æœŸæ—‹è½¬ 45 åº¦

### 3. Top 10 ä¸ªè‚¡æƒé‡è¶‹åŠ¿

#### è‚¡ç¥¨é€‰æ‹©
- åŸºäºå½“å‰æ—¥æœŸçš„ Top 10ï¼ˆæŒ‰æƒé‡æ’åºï¼‰
- è¿½è¸ªè¿™ 10 åªè‚¡ç¥¨åœ¨å†å²æ—¶æœŸçš„æƒé‡å˜åŒ–

#### å¯è§†åŒ–å…ƒç´ 
- **æŠ˜çº¿å›¾**ï¼š
  - æ¯åªè‚¡ç¥¨ä¸€æ¡çº¿ï¼ˆå…± 10 æ¡ï¼‰
  - ä¸åŒé¢œè‰²ï¼ˆè‡ªåŠ¨åˆ†é…ï¼‰
  - å¸¦æ ‡è®°ç‚¹
  - é€æ˜åº¦ 0.8ï¼ˆé¿å…çº¿æ¡è¿‡äºæ‹¥æŒ¤ï¼‰

- **å›¾ä¾‹**ï¼š
  - æ˜¾ç¤ºæ‰€æœ‰è‚¡ç¥¨ä»£ç 
  - 2 åˆ—å¸ƒå±€
  - å­—ä½“å¤§å° 8pt

#### ç‰¹æ®Šå¤„ç†
- å¦‚æœæŸåªè‚¡ç¥¨åœ¨å†å²ä¸­ä¸å­˜åœ¨ï¼Œæƒé‡è®°ä¸º 0
- æ–°å¢æŒä»“ä¼šæ˜¾ç¤ºä¸ºä» 0 å¼€å§‹ä¸Šå‡çš„è¶‹åŠ¿

## å®ç°ç»†èŠ‚

### ä¸»æ–¹æ³•
```python
def generate_comprehensive_report_image(
    self,
    holdings: List[Dict],
    current_df,
    previous_df,
    etf_symbol: str,
    date: str
) -> str:
```

### è¾…åŠ©æ–¹æ³•
```python
def _draw_holdings_table(ax, holdings, etf_symbol, date, top_n=15)
def _draw_fund_trend(ax, etf_symbol, date, csv_files, data_days)
def _draw_top10_trend(ax, current_df, etf_symbol, date, csv_files, data_days)
```

### å¸ƒå±€æŠ€æœ¯
- ä½¿ç”¨ `matplotlib.gridspec.GridSpec` è¿›è¡Œä¸»å¸ƒå±€åˆ†å‰²
- ä½¿ç”¨ `ax.figure.add_axes()` æ‰‹åŠ¨åˆ›å»ºå­å›¾ï¼ˆé¿å…åµŒå¥— GridSpec é—®é¢˜ï¼‰
- ä½¿ç”¨ç›¸å¯¹ä½ç½® (`pos.x0`, `pos.y0`, `pos.width`, `pos.height`)

### ä¸­æ–‡æ”¯æŒ
```python
plt.rcParams['font.sans-serif'] = ['Arial Unicode MS', 'SimHei', 'DejaVu Sans']
plt.rcParams['axes.unicode_minus'] = False
```

## æ•°æ®æ¥æº

### å†å²æ•°æ®å­˜å‚¨
```
data/holdings/{ETF}/
  â”œâ”€â”€ 2025-08-18.csv
  â”œâ”€â”€ 2025-08-19.csv
  â”œâ”€â”€ ...
  â””â”€â”€ 2025-11-14.csv
```

### CSV æ ¼å¼
```csv
company,ticker,cusip,shares,market_value,weight
Tesla Inc,TSLA,88160R101,1234567,280500000,10.50
```

### æ•°æ®ç´¯ç§¯
- æ¯æ—¥è‡ªåŠ¨ä¿å­˜å½“å¤©æ•°æ®
- å†å²æ•°æ®é€æ—¥ç´¯ç§¯
- æ”¯æŒè¡¥å……ç¼ºå¤±æ—¥æœŸï¼ˆ`--check-missed`ï¼‰

## ä½¿ç”¨åœºæ™¯

### 1. æ¯æ—¥è‡ªåŠ¨æ¨é€
```bash
python main.py --manual
```
- ç”Ÿæˆå½“æ—¥ç»¼åˆé•¿å›¾
- æ¨é€åˆ°ä¼ä¸šå¾®ä¿¡

### 2. æŒ‡å®šæ—¥æœŸ
```bash
python main.py --date 2025-11-14
```

### 3. æµ‹è¯•ç”Ÿæˆ
```bash
python scripts/test_comprehensive_image.py
```

## æ³¨æ„äº‹é¡¹

### æ•°æ®ä¸è¶³å¤„ç†
- **å°‘äº 5 å¤©**ï¼šæ˜¾ç¤ºè­¦å‘Šä¿¡æ¯ï¼Œä¸ç”Ÿæˆè¶‹åŠ¿å›¾
- **å°‘äº 30 å¤©**ï¼š1 ä¸ªæœˆè§†å›¾ä½¿ç”¨å…¨éƒ¨æ•°æ®
- **å°‘äº 90 å¤©**ï¼š3 ä¸ªæœˆè§†å›¾ä½¿ç”¨å…¨éƒ¨æ•°æ®

### æ€§èƒ½ä¼˜åŒ–
- å›¾ç‰‡ç”Ÿæˆæ—¶é—´ï¼šçº¦ 2-3 ç§’ï¼ˆ65 å¤©æ•°æ®ï¼‰
- å†…å­˜å ç”¨ï¼šçº¦ 100MBï¼ˆä¸´æ—¶ï¼‰
- ç£ç›˜å ç”¨ï¼šæ¯å¼ å›¾çº¦ 600-700 KB

### ä¼ä¸šå¾®ä¿¡å…¼å®¹æ€§
- âœ… æ”¯æŒ PNG Base64 ç¼–ç å‘é€
- âœ… é•¿å›¾å¯æ­£å¸¸æ˜¾ç¤ºï¼ˆç»æµ‹è¯•ï¼‰
- âœ… å›¾ç‰‡æ¸…æ™°åº¦è‰¯å¥½ï¼ˆ150 DPIï¼‰
- âš ï¸ å›¾ç‰‡å¤§å°é™åˆ¶ï¼š2MBï¼ˆå½“å‰çº¦ 700KBï¼‰

## æœªæ¥æ‰©å±•

### å¯èƒ½çš„ä¼˜åŒ–
1. **äº¤äº’å¼é•¿å›¾**ï¼šæ”¯æŒç‚¹å‡»å±•å¼€è¯¦æƒ…
2. **åŠ¨æ€æ—¶é—´èŒƒå›´**ï¼šå…è®¸ç”¨æˆ·é€‰æ‹©æ—¶é—´çª—å£
3. **æ›´å¤šæŒ‡æ ‡**ï¼šPEã€PBã€è¡Œä¸šåˆ†å¸ƒç­‰
4. **å¯¹æ¯”åˆ†æ**ï¼šå¤šä¸ª ETF å¯¹æ¯”
5. **PDF å¯¼å‡º**ï¼šç”Ÿæˆ PDF æŠ¥å‘Š

---

**æœ€åæ›´æ–°**ï¼š2025-11-14  
**ä½œè€…**ï¼šLucian  
**ç‰ˆæœ¬**ï¼š1.0
